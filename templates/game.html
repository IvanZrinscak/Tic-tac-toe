<!doctype html>
<title>Tic Tac Toe</title>
<h1>Tic Tac Toe - {{ dimension }}D</h1>
{% if winner is not none %}
  {% if winner == -1 %}
    <p>Draw!</p>
  {% else %}
    <p>Winner: {{ 'OX'[winner] }}</p>
  {% endif %}
  <form method="post" action="{{ url_for('reset') }}">
    <button type="submit">Play again</button>
  </form>
{% endif %}

{% if dimension == 2 %}
<table style="border-collapse: collapse;">
  {% for i in range(size) %}
  <tr>
    {% for j in range(size) %}
    <td style="width:40px;height:40px;text-align:center;border:1px solid #000;">
      {% if board[i][j] == -1 and winner is none %}
      <form method="post" action="{{ url_for('move') }}">
        <input type="hidden" name="row" value="{{ i }}">
        <input type="hidden" name="col" value="{{ j }}">
        <button style="width:40px;height:40px;"></button>
      </form>
      {% elif board[i][j] == 0 %}
      O
      {% elif board[i][j] == 1 %}
      X
      {% endif %}
    </td>
    {% endfor %}
  </tr>
  {% endfor %}
</table>
{% elif dimension == 3 %}
<div class="scene" style="width:{{ size * 50 }}px;height:{{ size * 50 }}px;">
  <div id="cube" class="board-3d" style="width:{{ size * 50 }}px;height:{{ size * 50 }}px;">
    {% for i in range(size) %}
      {% for j in range(size) %}
        {% for k in range(size) %}
          <div class="cell" style="transform: translate3d({{ j*50 }}px, {{ i*50 }}px, {{ k*50 }}px);">
            {% if board[i][j][k] == -1 and winner is none %}
            <form method="post" action="{{ url_for('move') }}">
              <input type="hidden" name="row" value="{{ i }}">
              <input type="hidden" name="col" value="{{ j }}">
              <input type="hidden" name="layer" value="{{ k }}">
              <button style="width:40px;height:40px;"></button>
            </form>
            {% elif board[i][j][k] == 0 %}O{% elif board[i][j][k] == 1 %}X{% endif %}
          </div>
        {% endfor %}
      {% endfor %}
    {% endfor %}
  </div>
</div>
<div class="controls">
  <label>Rotate X: <input type="range" id="rotX" min="-180" max="180" value="-20"></label>
  <label>Rotate Y: <input type="range" id="rotY" min="-180" max="180" value="30"></label>
</div>
<style>
  .scene { perspective: 600px; margin:20px auto; }
  .board-3d { position: relative; transform-style: preserve-3d; margin:auto; }
  .cell {
    position:absolute;
    width:40px;
    height:40px;
    border:1px solid #000;
    text-align:center;
    line-height:40px;
    background:#fff;
  }
</style>
<script>
const cube = document.getElementById('cube');
const rotX = document.getElementById('rotX');
const rotY = document.getElementById('rotY');
function update(){
  cube.style.transform = `rotateX(${rotX.value}deg) rotateY(${rotY.value}deg)`;
}
rotX.addEventListener('input', update);
rotY.addEventListener('input', update);
update();
</script>
{% endif %}

<p><a href="{{ url_for('index') }}">Choose dimension</a></p>
